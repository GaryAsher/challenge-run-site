<!-- Debug View Mode - Controlled from Dashboard only -->
<!-- No UI elements are shown here - all debug view controls are in /admin/test/ -->

<style>
/* Debug View Banner - Shows when debug view is active */
.debug-view-active-bar {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 1100;
  background: linear-gradient(135deg, #f59e0b, #d97706);
  color: #000;
  padding: 0.5rem 1rem;
  display: flex;
  justify-content: center;
  box-shadow: 0 2px 8px rgba(0,0,0,0.2);
}

.debug-view-active-bar[hidden] { display: none; }

.debug-view-active-content {
  display: flex;
  align-items: center;
  gap: 1rem;
  max-width: var(--page-max);
  width: 100%;
}

.debug-view-active-icon { font-size: 1.1rem; }

.debug-view-active-text {
  flex: 1;
  font-size: 0.9rem;
}

.debug-view-active-bar .btn--small {
  background: rgba(0,0,0,0.2);
  border: 1px solid rgba(0,0,0,0.3);
  color: #000;
}

.debug-view-active-bar .btn--small:hover {
  background: rgba(0,0,0,0.3);
}

/* Shift body down when debug view is active */
body.debug-view-active {
  padding-top: 44px;
}

body.debug-view-active .site-header {
  top: 44px;
}
</style>

<script>
// Debug View System - Controlled from Dashboard
(function() {
  const DEBUG_VIEW_KEY = 'crc-debug-view-role';
  
  const ROLE_INFO = {
    super_admin: { name: 'Super Admin', icon: 'üëë' },
    admin: { name: 'Admin', icon: 'üõ°Ô∏è' },
    verifier: { name: 'Verifier', icon: '‚úì' },
    user: { name: 'User', icon: 'üë§' }
  };
  
  // Check if debug view is active
  const activeDebugRole = sessionStorage.getItem(DEBUG_VIEW_KEY);
  
  if (activeDebugRole) {
    // Show debug view indicator
    const roleInfo = ROLE_INFO[activeDebugRole];
    if (roleInfo) {
      document.body.classList.add('debug-view-active');
      
      // Create the debug bar
      const bar = document.createElement('div');
      bar.className = 'debug-view-active-bar';
      bar.innerHTML = `
        <div class="debug-view-active-content">
          <span class="debug-view-active-icon">‚ö†Ô∏è</span>
          <span class="debug-view-active-text">
            <strong>Debug View:</strong> Viewing as ${roleInfo.name} ¬∑ Submissions disabled
          </span>
          <button type="button" class="btn btn--small" id="exit-debug-view">Return to Admin</button>
        </div>
      `;
      document.body.prepend(bar);
      
      // Exit button handler
      bar.querySelector('#exit-debug-view')?.addEventListener('click', () => {
        sessionStorage.removeItem(DEBUG_VIEW_KEY);
        window.location.reload();
      });
    }
  }
  
  // Expose debug view helpers globally
  window.CRCDebugView = {
    isActive: function() {
      return !!sessionStorage.getItem(DEBUG_VIEW_KEY);
    },
    
    getRole: function() {
      return sessionStorage.getItem(DEBUG_VIEW_KEY);
    },
    
    setRole: function(role) {
      if (role) {
        sessionStorage.setItem(DEBUG_VIEW_KEY, role);
      } else {
        sessionStorage.removeItem(DEBUG_VIEW_KEY);
      }
    },
    
    exit: function() {
      sessionStorage.removeItem(DEBUG_VIEW_KEY);
      window.location.reload();
    },
    
    // Check if submissions should be blocked
    shouldBlockSubmissions: function() {
      return this.isActive();
    }
  };
})();
</script>
