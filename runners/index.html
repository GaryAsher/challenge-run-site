---
layout: default
title: Runners
---

<div class="page-width" id="runners-controls">
  <h1>Runners</h1>
  <p class="muted">Jump by letter or search.</p>

  <div class="az" id="az">
    <a href="#0-9" class="az-wide">#</a>
    {% assign letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ" | split: "" %}
    {% for L in letters %}
      <a href="#{{ L }}">{{ L }}</a>
    {% endfor %}
    <a href="#other" class="az-wide">Other</a>
    <a href="#all" class="az-wide muted">All</a>
  </div>

  <div class="filter-wrap">
    <input
      id="q"
      class="filter"
      type="text"
      placeholder="Search within results..."
      autocomplete="off"
      inputmode="search"
      enterkeyhint="search"
      aria-label="Search runners"
    />
  </div>

  <div class="results-controls">
    <label class="muted" for="limit">Show:</label>
    <select id="limit" class="select">
      <option value="10" selected>10</option>
      <option value="25">25</option>
      <option value="50">50</option>
      <option value="100">100</option>
      <option value="0">All</option>
    </select>
  </div>

  <p class="muted" id="status"></p>
</div>

<div class="page-width">
  <div class="grid" id="runner-list">
    {% assign sorted = site.runners | sort: "title" %}
    {% for r in sorted %}
      {% assign runner_name = r.name | default: r.title | default: "Unknown" %}
      {% assign avatar = r.cover | default: "/assets/img/site/default-runner.png" %}
      <a
        class="runner-card runner-item card-lift"
        href="{{ r.url | relative_url }}"
        data-name="{{ runner_name | downcase }}"
        data-letter="{{ runner_name | strip | slice: 0, 1 | upcase }}"
      >
        <div class="runner-card__bg" data-bg="{{ avatar | relative_url }}"></div>
        <div class="runner-card__overlay">
          <div class="runner-card__title">{{ runner_name }}</div>
        </div>
      </a>
    {% endfor %}
  </div>
</div>

<!-- Load shared filter utilities -->
<script src="{{ '/assets/js/filter-utils.js' | relative_url }}"></script>

<script>
(function() {
  'use strict';

  // =========================================================
  // Use shared utilities
  // =========================================================
  var F = window.CRCFilters;
  var norm = F.norm;

  // =========================================================
  // Lazy Load Background Images
  // =========================================================
  F.lazyLoadBgs();

  // =========================================================
  // DOM: cache runner items + helpers
  // =========================================================
  var items = Array.from(document.querySelectorAll('.runner-item'));
  var totalItems = items.length; // Store total count
  var input = document.getElementById('q');
  var status = document.getElementById('status');
  var limitSelect = document.getElementById('limit');

  function getLimit() {
    return limitSelect ? Number(limitSelect.value) : 0;
  }

  function applyFilter() {
    var q = input ? norm(input.value) : '';
    var limit = getLimit();
    var matches = [];

    var hashMode = F.getHashMode();

    for (var i = 0; i < items.length; i++) {
      var el = items[i];
      var name = norm(el.dataset.name || '');
      var letter = (el.dataset.letter || '').toUpperCase();

      var okHash = F.matchesHashFilter(letter, hashMode);
      var ok = okHash && (!q || name.includes(q));

      if (ok) matches.push(el);
      el.style.display = 'none';
    }

    var shown = limit === 0 ? matches.length : Math.min(limit, matches.length);
    for (var j = 0; j < shown; j++) {
      matches[j].style.display = '';
    }

    if (status) {
      // Fixed: Show "X of [total]" instead of "X of [filtered]"
      var hashInfo = hashMode ? ' (section: ' + hashMode + ')' : '';
      status.textContent = 'Showing ' + shown + ' of ' + totalItems + ' runners' + hashInfo + '.';
    }
  }

  // =========================================================
  // Init A-Z navigation using shared utilities
  // =========================================================
  var azNav = F.initAzNav({
    onHashChange: applyFilter
  });

  // =========================================================
  // Event listeners
  // =========================================================
  if (input) input.addEventListener('input', applyFilter);
  if (limitSelect) limitSelect.addEventListener('change', applyFilter);

  // =========================================================
  // UX: blur controls when clicking outside the controls block
  // =========================================================
  var controlsRoot = document.getElementById('runners-controls');

  document.addEventListener('pointerdown', function(e) {
    if (controlsRoot && controlsRoot.contains(e.target)) return;
    if (input) input.blur();
    if (limitSelect) limitSelect.blur();
  });

  // Initial render
  applyFilter();
})();
</script>
