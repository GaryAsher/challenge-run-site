---
layout: default
title: Runners
---

<div class="page-width" id="runners-controls">
  <h1>Runners</h1>
  <p class="muted">Jump by letter or search.</p>

  <div class="az" id="az">
    <a href="#0-9" class="az-wide">#</a>
    {% assign letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ" | split: "" %}
    {% for L in letters %}
      <a href="#{{ L }}">{{ L }}</a>
    {% endfor %}
    <a href="#other" class="az-wide">Other</a>
    <a href="#all" class="az-wide muted">All</a>
  </div>

  <div class="filter-wrap">
    <input
      id="q"
      class="filter"
      type="text"
      placeholder="Search within results..."
      autocomplete="off"
      inputmode="search"
      enterkeyhint="search"
      aria-label="Search runners"
    />
  </div>

  <div class="results-controls">
    <label class="muted" for="limit">Show:</label>
    <select id="limit" class="select">
      <option value="10" selected>10</option>
      <option value="25">25</option>
      <option value="50">50</option>
      <option value="100">100</option>
      <option value="0">All</option>
    </select>
  </div>

  <p class="muted" id="status"></p>
</div>

<div class="page-width">
  <div class="grid" id="runner-list">
    {% assign sorted = site.runners | sort: "title" %}
    {% for r in sorted %}
      {% assign runner_name = r.name | default: r.title | default: "Unknown" %}
      {% assign avatar = r.cover | default: "/assets/img/site/default-runner.png" %}
      <a
        class="runner-card runner-item"
        href="{{ r.url | relative_url }}"
        data-name="{{ runner_name | downcase }}"
        data-letter="{{ runner_name | strip | slice: 0, 1 | upcase }}"
      >
        <div class="runner-card__bg" data-bg="{{ avatar | relative_url }}"></div>
        <div class="runner-card__overlay">
          <div class="runner-card__title">{{ runner_name }}</div>
        </div>
      </a>
    {% endfor %}
  </div>
</div>

<script>
// =========================================================
// Lazy Load Background Images
// =========================================================
(function() {
  const lazyBgs = document.querySelectorAll('[data-bg]');
  
  if ('IntersectionObserver' in window) {
    const observer = new IntersectionObserver(function(entries) {
      entries.forEach(function(entry) {
        if (entry.isIntersecting) {
          const el = entry.target;
          el.style.backgroundImage = "url('" + el.dataset.bg + "')";
          el.removeAttribute('data-bg');
          observer.unobserve(el);
        }
      });
    }, { rootMargin: '100px' });
    
    lazyBgs.forEach(function(el) { observer.observe(el); });
  } else {
    lazyBgs.forEach(function(el) {
      el.style.backgroundImage = "url('" + el.dataset.bg + "')";
    });
  }
})();

// =========================================================
// DOM: cache runner items + helpers
// =========================================================
const items = Array.from(document.querySelectorAll(".runner-item"));
const norm = s => (s || "").trim().toLowerCase();
const input = document.getElementById("q");
const status = document.getElementById("status");
const limitSelect = document.getElementById("limit");
const getLimit = () => (limitSelect ? Number(limitSelect.value) : 0);

function applyFilter() {
  const q = input ? norm(input.value) : "";
  const limit = getLimit();
  const matches = [];

  const rawHash = (location.hash || "").replace("#", "").toUpperCase();
  const hashMode = rawHash && rawHash !== "ALL" ? rawHash : "";

  for (const el of items) {
    const name = norm(el.dataset.name || "");
    const letter = (el.dataset.letter || "").toUpperCase();

    const startsWithDigit = letter >= "0" && letter <= "9";
    const startsWithAtoZ = letter >= "A" && letter <= "Z";

    const okHash =
      !hashMode ||
      (hashMode === "0-9" && startsWithDigit) ||
      (hashMode === "OTHER" && !startsWithDigit && !startsWithAtoZ) ||
      (hashMode.length === 1 && letter === hashMode);

    const ok = okHash && (!q || name.includes(q));

    if (ok) matches.push(el);
    el.style.display = "none";
  }

  const shown = limit === 0 ? matches.length : Math.min(limit, matches.length);
  for (let i = 0; i < shown; i++) matches[i].style.display = "";

  if (status) {
    status.textContent =
      `${shown} shown of ${matches.length} matches` +
      (hashMode ? ` (section: ${hashMode})` : "");
  }
}

window.addEventListener("hashchange", applyFilter);

if (input) input.addEventListener("input", applyFilter);
if (limitSelect) limitSelect.addEventListener("change", applyFilter);

// =========================================================
// UX: blur controls when clicking outside the controls block
// =========================================================
const controlsRoot = document.getElementById("runners-controls");

document.addEventListener("pointerdown", (e) => {
  if (controlsRoot && controlsRoot.contains(e.target)) return;
  if (input) input.blur();
  if (limitSelect) limitSelect.blur();
});

applyFilter();
</script>
