---
layout: default
---

{% assign game = site.games | where: "game_id", page.game_id | first %}

<!-- =========================================================
     Back link to Game
     ========================================================= -->
<div class="page-width">
  <p class="muted page-back">
    {% if game %}
      <a href="{{ game.url | relative_url }}">← Back to {{ game.name }}</a>
    {% else %}
      <a href="{{ '/games/' | relative_url }}">← Games</a>
    {% endif %}
  </p>
</div>

<!-- =========================================================
     Category header
     ========================================================= -->
<div class="page-width">
  <h1>{{ page.title }}</h1>
  <p class="muted">Category runs for this game.</p>
</div>

<!-- =========================================================
     Runs filtered by category_slug
     ========================================================= -->
<div class="page-width">

  <!-- Normalize + clean runs so Liquid filters do not crash -->
  {% assign cleaned = "" | split: "" %}
  {% for r in site.runs %}
    {% if r and r.game_id and r.category_slug %}
      {% assign cleaned = cleaned | push: r %}
    {% endif %}
  {% endfor %}

  {% assign runs = cleaned
    | where: "game_id", page.game_id
    | where: "category_slug", page.category_slug
    | sort: "date_completed"
    | reverse
  %}

  {% if runs and runs.size > 0 %}
    <div class="table-wrap">
      <table class="runs-table">
        <thead>
          <tr>
            <th>Runner</th>
            <th>Challenge</th>
            <th>Time</th>
            <th>Date</th>
            <th>Video</th>
          </tr>
        </thead>

        <tbody>
          {% for r in runs %}
            {% assign meta = site.data.challenges[r.challenge_id] %}
            {% assign challenge_label = r.challenge_id %}
            {% if meta and meta.label %}
              {% assign challenge_label = meta.label %}
            {% endif %}

            {% assign video_url = r.video_link | default: r.video %}

            <tr>
              <td>
                {% if r.runner_id %}
                  <a href="{{ '/runners/' | relative_url }}{{ r.runner_id }}/">
                    {{ r.runner | default: r.runner_id }}
                  </a>
                {% else %}
                  {{ r.runner | default: "—" }}
                {% endif %}
              </td>

              <td>{{ challenge_label }}</td>

              <td>{{ r.time | default: "—" }}</td>

              <td>{{ r.date_completed | default: "—" }}</td>

              <td>
                {% if video_url %}
                  <a href="{{ video_url }}" target="_blank" rel="noopener">Link</a>
                {% else %}
                  —
                {% endif %}
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% else %}
    <div class="card">
      <p class="muted">No runs found for this category.</p>
    </div>
  {% endif %}
</div>
