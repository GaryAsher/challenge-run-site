{% assign game = site.games | where: "game_id", page.game_id | first %}

---
layout: default
---

<!-- =========================================================
     Back link to Game
     ========================================================= -->
<div class="page-width">
  <p class="muted page-back">
    <a href="{{ '/games/' | relative_url }}{{ page.game_id }}/">
      ← Back to {{ page.game_id }}
    </a>
  </p>
</div>

<!-- =========================================================
     Category header
     ========================================================= -->
<div class="page-width">
  <h1>{{ page.title }}</h1>
  <p class="muted">Category runs for this game.</p>
</div>

<!-- =========================================================
     Runs filtered by category
     ========================================================= -->
<div class="page-width">

  {% assign runs = site.data.runs
    | where: "game_id", page.game_id
    | where: "category", page.category
  %}

  {% if runs and runs.size > 0 %}
    <div class="table-wrap">
      <table class="runs-table">
        <thead>
          <tr>
            <th>Runner</th>
            <th>Challenge</th>
            <th>Time</th>
            <th>Date</th>
            <th>Video</th>
          </tr>
        </thead>
        <tbody>
          {% for r in runs %}
            <tr>
              <td>
                <a href="{{ '/runners/' | relative_url }}{{ r.runner_id }}/">
                  {{ r.runner }}
                </a>
              </td>
              <td>
                {% assign meta = site.data.challenges[r.challenge_id] %}
                {{ meta.label | default: r.challenge_id }}
              </td>
              <td>{{ r.time | default: "—" }}</td>
              <td>{{ r.date_completed }}</td>
              <td>
                {% if r.video %}
                  <a href="{{ r.video }}" target="_blank" rel="noopener">Link</a>
                {% else %}
                  —
                {% endif %}
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% else %}
    <div class="card">
      <p class="muted">No runs found for this category.</p>
    </div>
  {% endif %}

</div>
