---
layout: default
---

<!-- ============================================================
     Runner Tabs (Profile / Runs / Other)
     ============================================================ -->
<nav class="runner-tabs" id="runner-tabs">
  <button class="tab active" data-tab="profile" type="button">Profile</button>
  <button class="tab" data-tab="runs" type="button">Completed Runs</button>
  <button class="tab" data-tab="other" type="button">Something Else</button>
</nav>

<!-- ============================================================
     Back Link (kept in page-width for alignment)
     ============================================================ -->
<div class="page-width">
  <p class="muted">
    <a href="{{ '/runners/' | relative_url }}">← Runners</a>
  </p>
</div>

<!-- ============================================================
     Runner Avatar Source (fallback if cover is missing)
     ============================================================ -->
{% assign avatar = page.cover | default: "/assets/img/site/default-runner.png" %}

<!-- ============================================================
     Runner Header Row (Avatar left, Socials right)
     ============================================================ -->
<div class="page-width">
  <section class="runner-top">
    <div class="runner-left">
      <div
        class="runner-avatar"
        style="background-image: url('{{ avatar | relative_url }}');"
        aria-label="{{ page.name }} profile picture"
      ></div>

      <div class="runner-name">
        <h1>{{ page.name }}</h1>
        {% if page.status %}
          <p class="muted runner-status">{{ page.status }}</p>
        {% endif %}
      </div>
    </div>

    <div class="runner-right">
      <div class="runner-links">
        {% if page.twitch %}
          <a class="runner-link" href="{{ page.twitch }}" target="_blank" rel="noreferrer">
            <span>Twitch</span>
          </a>
        {% endif %}

        {% if page.youtube %}
          <a class="runner-link" href="{{ page.youtube }}" target="_blank" rel="noreferrer">
            <span>YouTube</span>
          </a>
        {% endif %}

        {% if page.discord %}
          <a class="runner-link" href="{{ page.discord }}" target="_blank" rel="noreferrer">
            <span>Discord</span>
          </a>
        {% endif %}

        {% if page.twitter %}
          <a class="runner-link" href="{{ page.twitter }}" target="_blank" rel="noreferrer">
            <span>Twitter/X</span>
          </a>
        {% endif %}
      </div>
    </div>
  </section>
</div>

<div class="page-width">
  <!-- ==========================================================
       PROFILE PANEL
       ========================================================== -->
  <section class="tab-panel active" data-panel="profile">
    {% if content and content != "" %}
      <div class="card">{{ content }}</div>
    {% endif %}

    {% if page.games and page.games.size > 0 %}
      <div class="card">
        <h2>Games</h2>

        <div class="grid">
          {% for gid in page.games %}
            {% assign g = site.games | where: "game_id", gid | first %}
            {% if g %}
              <a href="{{ g.url | relative_url }}" class="game-card">
                <div class="game-card__bg" style="background-image: url('{{ g.cover | relative_url }}');"></div>
                <div class="game-card__overlay">
                  <div class="game-card__title">{{ g.name }}</div>
                </div>
              </a>
            {% else %}
              <div class="card">{{ gid }}</div>
            {% endif %}
          {% endfor %}
        </div>
      </div>
    {% endif %}
  </section>

  <!-- ==========================================================
       RUNS PANEL
       ========================================================== -->
  <section class="tab-panel" data-panel="runs">
    {% assign cleaned = "" | split: "" %}
    {% for r in site.runs %}
      {% if r and r.runner_id %}
        {% assign cleaned = cleaned | push: r %}
      {% endif %}
    {% endfor %}

    {% assign rid = page.runner_id | default: "" | strip | downcase %}
    {% assign runs = cleaned | where: "runner_id", rid | sort: "date_completed" | reverse %}

    {% if runs and runs.size > 0 %}
      <div class="card">
        <h2>Completed Runs</h2>
        <p class="muted">{{ runs.size }} run{% if runs.size != 1 %}s{% endif %} across multiple games</p>
      </div>

      {% comment %} Group runs by game {% endcomment %}
      {% assign game_ids = runs | map: "game_id" | uniq %}

      <div class="runner-games-grid">
        {% for gid in game_ids %}
          {% assign g = site.games | where: "game_id", gid | first %}
          {% assign game_runs = runs | where: "game_id", gid %}
          {% assign game_cover = "/assets/img/site/default-game.jpg" %}
          {% if g and g.cover %}
            {% assign game_cover = g.cover %}
          {% endif %}

          <div class="runner-game-card" data-game-id="{{ gid }}">
            <div class="runner-game-card__header" style="background-image: url('{{ game_cover | relative_url }}');">
              <div class="runner-game-card__overlay">
                <div class="runner-game-card__title">
                  {% if g %}
                    <a href="{{ g.url | relative_url }}">{{ g.name }}</a>
                  {% else %}
                    {{ gid }}
                  {% endif %}
                </div>
                <div class="runner-game-card__count muted">{{ game_runs.size }} run{% if game_runs.size != 1 %}s{% endif %}</div>
              </div>
            </div>

            <div class="runner-game-card__runs" hidden>
              {% for r in game_runs %}
                {% assign ch_id = r.challenge_id | default: "" | strip %}
                {% assign ch_label = "" %}
                {% if ch_id != "" %}
                  {% assign chmeta = site.data.challenges[ch_id] %}
                  {% assign ch_label = chmeta.label | default: ch_id %}
                {% endif %}

                {% assign r_texts = "" | split: "" %}
                {% if r.restrictions and r.restrictions != empty %}
                  {% if r.restrictions.first %}
                    {% assign r_texts = r.restrictions %}
                  {% elsif r.restrictions != "[]" and r.restrictions != "" %}
                    {% assign r_texts = r.restrictions | split: "," %}
                  {% endif %}
                {% endif %}
                {% assign r_clean = "" | split: "" %}
                {% for rr in r_texts %}
                  {% assign t = rr | strip %}
                  {% if t != "" and t != "[]" %}
                    {% assign r_clean = r_clean | push: t %}
                  {% endif %}
                {% endfor %}
                {% assign r_texts = r_clean | uniq %}

                <div class="runner-run-item">
                  <div class="runner-run-item__main">
                    {% if ch_label != "" and ch_label != "—" %}
                      <span class="tag">{{ ch_label }}</span>
                    {% endif %}
                    {% if r.category and r.category != "" %}
                      <span class="muted">{{ r.category }}</span>
                    {% endif %}
                  </div>
                  <div class="runner-run-item__meta muted">
                    {% if r.time_primary or r.time %}
                      <span>{{ r.time_primary | default: r.time }}</span>
                    {% endif %}
                    {% if r.date_completed %}
                      <span>{{ r.date_completed }}</span>
                    {% endif %}
                    {% assign r_video = r.video_link | default: r.video %}
                    {% if r_video and r_video != "" %}
                      <a href="{{ r_video }}" target="_blank" rel="noopener">Video</a>
                    {% endif %}
                  </div>
                  {% if r_texts and r_texts.size > 0 %}
                    <div class="runner-run-item__tags">
                      {% for x in r_texts %}
                        <span class="tag tag--small">{{ x }}</span>
                      {% endfor %}
                    </div>
                  {% endif %}
                </div>
              {% endfor %}
            </div>

            <button type="button" class="runner-game-card__toggle btn" data-toggle-runs>
              Show Runs ▾
            </button>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="card">
        <p class="muted">No runs have been added yet.</p>
      </div>
    {% endif %}
  </section>

  <!-- ==========================================================
       OTHER PANEL
       ========================================================== -->
  <section class="tab-panel" data-panel="other">
    <div class="card">
      <h2>Something Else</h2>
      <p class="muted">Placeholder tab.</p>
    </div>
  </section>
</div>

<!-- ============================================================
     Tabs Script (switch panels without changing pages)
     ============================================================ -->
<script>
(function () {
  const tabs = Array.from(document.querySelectorAll(".runner-tabs .tab"));
  const panels = Array.from(document.querySelectorAll(".tab-panel[data-panel]"));

  function setActive(name) {
    for (const t of tabs) t.classList.toggle("active", t.dataset.tab === name);
    for (const p of panels) p.classList.toggle("active", p.dataset.panel === name);
  }

  tabs.forEach(t => {
    t.addEventListener("click", () => setActive(t.dataset.tab));
  });
})();
</script>
