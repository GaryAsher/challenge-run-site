---
layout: default
title: Games
---

<h1>Games</h1>
<p class="muted">Jump by letter or filter by category.</p>

<div class="az" id="az">
  <a href="#0-9">#</a>
  {% assign letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ" | split: "" %}
  {% for L in letters %}
    <a href="#{{ L }}">{{ L }}</a>
  {% endfor %}
  <a href="#other">Other</a>
  <a href="#all" class="muted">All</a>
</div>

<div class="filter-wrap">
  <input id="q" class="filter" placeholder="Search within results..." autocomplete="off" />
</div>

<!-- TAG FILTER -->
<div class="tag-filter" id="tag-filter">
  <div class="muted" style="margin-bottom: 0.35rem;">Filter by tags:</div>
  <div class="tag-picker">
    <div class="tag-picked" id="tag-picked"></div>
    <div class="filter-wrap">
      <input id="tag-search" class="tag-search" type="text" placeholder="Type a tag..." autocomplete="off" />
    </div>
    <div class="tag-suggestions" id="tag-suggestions" hidden></div>
  </div>
</div>

<!-- CHALLENGE FILTER -->
<div class="tag-filter" id="challenge-filter">
  <div class="muted" style="margin-bottom: 0.35rem;">Filter by challenges:</div>
  <div class="tag-picker">
    <div class="tag-picked" id="challenge-picked"></div>
    <div class="filter-wrap">
      <input id="challenge-search" class="tag-search" type="text" placeholder="Type a challenge..." autocomplete="off" />
    </div>
    <div class="tag-suggestions" id="challenge-suggestions" hidden></div>
  </div>
</div>

<div class="results-controls">
  <label class="muted" for="limit">Show:</label>
  <select id="limit" class="select">
    <option value="10" selected>10</option>
    <option value="25">25</option>
    <option value="50">50</option>
    <option value="100">100</option>
    <option value="250">250</option>
    <option value="0">All</option>
  </select>
</div>

<p class="muted" id="status"></p>

<div class="grid" id="game-list">
  {% assign sorted = site.games | sort: "name" %}
  {% for g in sorted %}
    <a
      class="game-card game-item"
      href="{{ g.url | relative_url }}"
      data-name="{{ g.name | downcase }}"
      data-tags="{{ g.tags | join: ',' | downcase }}"
      data-challenges="{{ g.challenges | default: empty | join: ',' | downcase }}"
    >
      {% assign game_cover = g.cover | default: "/assets/img/site/default-game.jpg" %}
      <div class="game-card__bg" style="background-image: url('{{ game_cover | relative_url }}');"></div>
      <div class="game-card__overlay">
        <div class="game-card__title">{{ g.name }}</div>
      </div>
    </a>
  {% endfor %}
</div>

<script>
const items = Array.from(document.querySelectorAll(".game-item"));
const input = document.getElementById("q");
const status = document.getElementById("status");
const limitSelect = document.getElementById("limit");

const tagFilterEl = document.getElementById("tag-filter");
const tagPickedEl = document.getElementById("tag-picked");
const tagSearchEl = document.getElementById("tag-search");
const tagSugEl = document.getElementById("tag-suggestions");

const challengeFilterEl = document.getElementById("challenge-filter");
const challengePickedEl = document.getElementById("challenge-picked");
const challengeSearchEl = document.getElementById("challenge-search");
const challengeSugEl = document.getElementById("challenge-suggestions");

const activeTags = new Set();
const activeChallenges = new Set();

const TAGS = [
{% for pair in site.data.tags %}
{ id: "{{ pair[0] }}", label: "{{ pair[1].label }}" }{% unless forloop.last %},{% endunless %}
{% endfor %}
].sort((a,b)=>a.label.localeCompare(b.label));

const CHALLENGES = [
{% for pair in site.data.challenges %}
{ id: "{{ pair[0] }}", label: "{{ pair[1].label }}" }{% unless forloop.last %},{% endunless %}
{% endfor %}
].sort((a,b)=>a.label.localeCompare(b.label));

const norm = s => (s || "").trim().toLowerCase();

function renderPicked(set, list, el) {
  el.innerHTML = "";
  for (const id of set) {
    const meta = list.find(x => norm(x.id) === id);
    const chip = document.createElement("button");
    chip.className = "tag-chip";
    chip.textContent = meta ? meta.label : id;
    chip.onclick = () => { set.delete(id); applyFilter(); renderAll(); };
    el.appendChild(chip);
  }
}

function renderSuggestions(query, set, list, el) {
  const q = norm(query);
  el.innerHTML = "";
  list.filter(x => !set.has(norm(x.id)) && (!q || norm(x.label).includes(q)))
      .slice(0,24)
      .forEach(x => {
        const b = document.createElement("button");
        b.className = "tag-suggestion";
        b.textContent = x.label;
        b.onclick = () => { set.add(norm(x.id)); applyFilter(); renderAll(); };
        el.appendChild(b);
      });
  el.hidden = false;
}

function applyFilter() {
  const q = norm(input.value);
  const limit = Number(limitSelect.value);
  const matches = [];

  for (const el of items) {
    const name = el.dataset.name;
    const tags = (el.dataset.tags || "").split(",").map(norm);
    const challenges = (el.dataset.challenges || "").split(",").map(norm);

    const ok =
      (!q || name.includes(q)) &&
      [...activeTags].every(t => tags.includes(t)) &&
      [...activeChallenges].every(c => challenges.includes(c));

    if (ok) matches.push(el);
    el.style.display = "none";
  }

  matches.slice(0, limit || matches.length).forEach(el => el.style.display = "");
  status.textContent = `${matches.length} matches`;
}

function renderAll() {
  renderPicked(activeTags, TAGS, tagPickedEl);
  renderPicked(activeChallenges, CHALLENGES, challengePickedEl);
}

tagSearchEl.oninput = () => renderSuggestions(tagSearchEl.value, activeTags, TAGS, tagSugEl);
challengeSearchEl.oninput = () => renderSuggestions(challengeSearchEl.value, activeChallenges, CHALLENGES, challengeSugEl);

input.oninput = applyFilter;
limitSelect.onchange = applyFilter;

renderAll();
applyFilter();
</script>
